import json
from shapely.geometry import Point, Polygon, shape, mapping
from shapely.ops import unary_union
import sys
aqi = []
temp = []
total = 0
filename = "polygonized.json"
with open(filename) as f:
    data = json.load(f)
sorted_data = sorted(data['features'], key=lambda x: x["properties"]["AQI"], reverse=True)
route = [[14.653869,121.068501],[14.65387,121.068549],[14.653871,121.068617],[14.653873,121.068796],[14.653873,121.06881],[14.653874,121.068877],[14.653886,121.069678],[14.653887,121.069787],[14.653889,121.069895],[14.65389,121.069971],[14.653898,121.070529],[14.6539,121.070678],[14.653901,121.070794],[14.653903,121.070897],[14.653905,121.07108],[14.653906,121.071159],[14.65391,121.071404],[14.653914,121.07166],[14.653917,121.071908],[14.653918,121.072016],[14.653921,121.072166],[14.653923,121.072325],[14.653925,121.072483],[14.653936,121.072662],[14.65391,121.072704],[14.653891,121.072721],[14.653877,121.07273],[14.653854,121.072747],[14.653831,121.072774],[14.65381,121.07278],[14.65379,121.072783],[14.653749,121.072787],[14.653714,121.072791],[14.6537,121.072792],[14.653659,121.072796],[14.653585,121.072798],[14.653589,121.074052],[14.653589,121.074079],[14.65359,121.074147],[14.65359,121.074186],[14.653585,121.074297],[14.653184,121.074298],[14.652614,121.0743],[14.652585,121.0743],[14.652381,121.0743],[14.65105,121.074303],[14.651012,121.074303],[14.650201,121.074305],[14.649449,121.074308],[14.649156,121.074307],[14.648645,121.074308],[14.648549,121.074308],[14.648511,121.074306],[14.648341,121.074308],[14.648054,121.074303],[14.647677,121.074296],[14.647585,121.074294],[14.647191,121.074284],[14.647055,121.07428],[14.646925,121.074277],[14.646903,121.074277],[14.646794,121.074275],[14.646603,121.074273],[14.646332,121.074297],[14.646147,121.074321],[14.645899,121.074354],[14.645238,121.074441],[14.64501,121.074471],[14.644587,121.074528],[14.644442,121.07454],[14.644237,121.074567],[14.643992,121.074595],[14.643438,121.074629],[14.642898,121.074614],[14.642448,121.074593],[14.642238,121.074584],[14.641606,121.074557],[14.64142,121.074549],[14.64139,121.074419],[14.641305,121.074416],[14.641303,121.074416],[14.641284,121.074843],[14.64128,121.074843],[14.641217,121.07484],[14.641066,121.074871],[14.64086,121.074914],[14.640772,121.074998],[14.640726,121.075328],[14.640772,121.075602],[14.640882,121.07581],[14.640834,121.075847],[14.6408,121.075874],[14.640763,121.075902],[14.64069,121.075959],[14.640561,121.076047],[14.640528,121.076069],[14.640386,121.076156],[14.64037,121.076188],[14.640347,121.076229],[14.640316,121.076283],[14.640262,121.076424],[14.640202,121.076602],[14.640123,121.07694],[14.640118,121.076957],[14.64008,121.076958],[14.640017,121.077148],[14.639987,121.077238],[14.639982,121.077604],[14.639901,121.077831],[14.639916,121.077889],[14.639946,121.078009],[14.639962,121.07807],[14.640246,121.078224],[14.640112,121.078487],[14.64006,121.078588]]
for i in route:
    i[0], i[1] = i[1], i[0]
points = [Point(i[0], i[1]) for i in route]
for polygon in data['features']:
    if polygon["properties"]["AQI"] <= 500:
        coordinates = polygon["geometry"]
        temp.append([shape(coordinates),polygon["properties"]["AQI"]])
for i in points:
    for j in temp:
        if j[0].contains(i):
            aqi.append([j,i])
            break
for i in range(len(aqi)-1):
    distance = aqi[i][1].distance(aqi[i+1][1])
    level = aqi[i][0][1]
    total += distance*level
print(total)